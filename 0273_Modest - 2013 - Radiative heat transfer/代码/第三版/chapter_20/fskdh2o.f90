   SUBROUTINE Fskdh2o(Tg,Tb,k,x,gcal)
   ! Modest & Singh correlation for H2O
   ! Input variables:
   !	Tg : double precision scalar, local gas temperature
   !	Tb : double precision scalar, Planck function temperature
   !	k  : double precision scalar, pressure based absorption coefficient (k) value
   !	x  : double precision scalar, mole fraction of water
   ! Output variables:
   !	gcal: double precision scalar, correspond g value
   IMPLICIT NONE
   INTEGER  :: l,m,n
   DOUBLE PRECISION :: bigp,xi,xis,gcal,Tg,Tb,k,x
   DOUBLE PRECISION :: almn(0:3,0:3,0:3),blmn(0:1,0:2,0:2)
   DATA almn /   0.11727390382594D+01,  -0.79233701090528D+00, &
         0.45678148180508D+00,  -0.67355817198147D-01, &
         0.88261090723411D+00,   0.33022055332160D+01, &
        -0.20480774079693D+01,   0.39413787303095D+00, &
        -0.28464957949024D+00,  -0.16339745840812D+01, &
         0.10992463891114D+01,  -0.20874526756693D+00, &
         0.52641314250448D-01,   0.26822395746801D+00, &
        -0.18705727454161D+00,   0.35072746249398D-01, &
         0.27995556315637D+00,   0.52705545762030D+00, &
        -0.43155723889914D+00,   0.13503443577078D+00, &
         0.13110405345336D+01,  -0.13535195345260D-01, &
         0.23946512473986D-01,  -0.37574344913040D-01, &
        -0.61658230571746D+00,  -0.81576227057821D-01, &
         0.15935609591997D+00,  -0.22954767376049D-01, &
         0.10234050877759D+00,   0.17012916696670D-01, &
        -0.38405881155705D-01,   0.65175870635333D-02, &
         0.86277669711840D-01,   0.34948997482539D+00, &
        -0.20189360135442D+00,   0.55391027176244D-01, &
         0.31365825397722D+00,  -0.10602534655868D+01, &
         0.85700017183181D+00,  -0.17833034900819D+00, &
        -0.13677988714456D+00,   0.57680694002893D+00, &
        -0.48058859578561D+00,   0.91345067362557D-01, &
         0.20072348102088D-01,  -0.97271482624167D-01, &
         0.81344362337134D-01,  -0.14501502880846D-01, &
         0.55203164526025D-01,  -0.90309091713057D-01, &
         0.22803582483225D+00,  -0.50412939547401D-01, &
        -0.26467885332271D-01,  -0.63565757156191D-01, &
        -0.13107199511879D+00,   0.37171590780014D-01, &
         0.13331890848674D-01,   0.67414123184757D-01, &
         0.25816812913826D-01,  -0.13250915677532D-01, &
        -0.25024127061198D-02,  -0.13749665053479D-01, &
        -0.14234808917787D-02,   0.19916213085042D-02/
   
   DATA blmn /  -0.89871032164934D+00,   0.53900322055117D+00, &
         0.10116065458653D+01,  -0.58957492617859D+00, &
        -0.48279630261745D+00,   0.27472330190048D+00, &
         0.10985053030604D+01,  -0.58298454159600D-01, &
        -0.10454377949888D+01,   0.11542729243720D+00, &
         0.47174494979936D+00,  -0.56228311600148D-01, &
        -0.22529697071712D+00,  -0.60603363774397D-02, &
         0.18432229208060D+00,  -0.16727319474944D-01, &
        -0.76913213683316D-01,   0.10350069781625D-01/
 

   xi=LOG10(k)  ! log 10
   xis=0d0  ! if x=0, xis=0 because of x**(m+1)
   DO l=0,2
     DO m=0,2
       DO n=0,1
         xis=xis+blmn(n,m,l)*(Tg/1000d0)**l*xi**n*x**(m+1)
       ENDDO !n
     ENDDO !m
   ENDDO !l
   bigp=0d0
   DO l=0,3
     DO m=0,3
       DO n=0,3
         bigp=bigp+almn(n,m,l)*(Tg/1000d0)**n*(Tb/1000d0)**m*(xi+xis)**l
       ENDDO !n
     ENDDO !m
   ENDDO !l
   gcal=0.5d0*tanh(bigp)+0.5d0
   RETURN
   END SUBROUTINE Fskdh2o


