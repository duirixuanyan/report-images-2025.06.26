	SUBROUTINE FRESNEL(N,K,TH,RHOS,RHOP,RHO)
	REAL*8 N,K,TH,RHOS,RHOP,RHO,C1,P2,Q2,CT,C2,C3,P,Q
	C1=N*N-K*K-DSIN(TH)**2
	P2=.5D0*(DSQRT(C1*C1+(2.D0*N*K)**2)+C1)
	Q2=P2-C1
	CT=DCOS(TH)
	C2=(N*N-K*K)*CT
	C3=2.D0*N*K*CT
	P=DSQRT(P2)
	Q=DSQRT(Q2)
	RHOP=((P-C2)**2+(Q-C3)**2)/((P+C2)**2+(Q+C3)**2)
	RHOS=((CT-P)**2+Q2)/((CT+P)**2+Q2)
	RHO=.5D0*(RHOP+RHOS)
	RETURN
	END
